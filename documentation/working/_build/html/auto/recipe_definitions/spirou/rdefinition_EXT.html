


<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>apero_extract_spirou &#8212; APERO 0.8.001 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bizstyle.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/apero.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="apero_wave_ref_spirou" href="rdefinition_WAVEREF.html" />
    <link rel="prev" title="apero_leak_ref_spirou" href="rdefinition_LEAKREF.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="_static/images/fonta/css/font-awesome.min.css">



    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
    <style>
      table.right { float: left; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script>
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">

  <ul>
    <li><a title="Home" href="../../../index.html">
        <i class="fa fa-home fa-3x" aria-hidden="true"></i></a></li>
    <li><a title="install" href="../../../user/general/installation.html">
        <i class="fa fa-cog fa-3x" aria-hidden="true"></i></a></li>
    <li><a title="github" href="https://github.com/njcuk9999/apero-drs">
        <i class="fa fa-git-square fa-3x" aria-hidden="true"></i></a></li>
    <li><a title="download pdf" href="../../../apero-docs.pdf">
        <i class="fa fa-download fa-3x" aria-hidden="true"></i></a></li>
  </ul>
    <div>
    <a href="../../../index.html">
      <img src="../../../_static/images/apero_logo.png" alt="APERO" />
    </a>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A PipelinE to Reduce Observations
    </div>

</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="rdefinition_WAVEREF.html" title="apero_wave_ref_spirou"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rdefinition_LEAKREF.html" title="apero_leak_ref_spirou"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">APERO 0.8.001 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../main/spirou/main_spirou.html" >SPIRou documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="recipes.html" accesskey="U">Recipes (SPIROU)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">apero_extract_spirou</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">apero_extract_spirou</a><ul>
<li><a class="reference internal" href="#description">1. Description</a><ul>
<li><a class="reference internal" href="#extraction">Extraction</a><ul>
<li><a class="reference internal" href="#optimal-extraction">Optimal extraction</a></li>
<li><a class="reference internal" href="#berv-correction">BERV correction</a></li>
<li><a class="reference internal" href="#leak-correction">Leak Correction</a></li>
<li><a class="reference internal" href="#thermal-correction">Thermal correction</a></li>
<li><a class="reference internal" href="#s1d-generation">S1D generation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#schematic">2. Schematic</a></li>
<li><a class="reference internal" href="#usage">3. Usage</a></li>
<li><a class="reference internal" href="#optional-arguments">4. Optional Arguments</a></li>
<li><a class="reference internal" href="#special-arguments">5. Special Arguments</a></li>
<li><a class="reference internal" href="#output-directory">6. Output directory</a></li>
<li><a class="reference internal" href="#output-files">7. Output files</a></li>
<li><a class="reference internal" href="#debug-plots">8. Debug plots</a></li>
<li><a class="reference internal" href="#summary-plots">9. Summary plots</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="rdefinition_LEAKREF.html"
                          title="previous chapter">apero_leak_ref_spirou</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="rdefinition_WAVEREF.html"
                          title="next chapter">apero_wave_ref_spirou</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/auto/recipe_definitions/spirou/rdefinition_EXT.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="apero-extract-spirou">
<span id="recipes-spirou-ext"></span><h1>apero_extract_spirou<a class="headerlink" href="#apero-extract-spirou" title="Permalink to this heading">¶</a></h1>
<section id="description">
<h2>1. Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>SHORTNAME: EXT</p>
<section id="extraction">
<h3>Extraction<a class="headerlink" href="#extraction" title="Permalink to this heading">¶</a></h3>
<p>The extraction recipe takes any preprocessed file (as many as given by the user but in general just one single file).
The files are combined (if requested) and are calibrated using our standard image calibration technique. Once
calibrated, the correct (closest in time) order profile (<cite>ORDERP</cite>), positions of the orders (<cite>LOCO</cite>), <cite>SHAPELOCAL</cite>,
shape reference (x and y maps), and wavelength solution are loaded for each fiber (AB, A, B, and C). The order profiles
and input image are transformed to the reference FP grid using the affine transformation, and using the shape x and y
maps the image is corrected for the slicer geometry, the tilt and the bending due to the echelle orders.</p>
<p>The extraction recipe then extracts the flux (using optimal extraction), calculates the barycentric correction,
corrects contamination from the reference fiber (if an FP is present in the reference fiber), corrects for the flat,
corrects for the thermal contribution and generates the 1D spectrum.</p>
<section id="optimal-extraction">
<h4>Optimal extraction<a class="headerlink" href="#optimal-extraction" title="Permalink to this heading">¶</a></h4>
<p>Once the image and the order profile (from localization) have been corrected for the slicer geometry and curvature of
the echelle orders we extract out the combined flux in the science channels (fibers A and B) to create a fiber AB,
as well as extracting out the flux in A and B (for polarization work) and C separately (for the reference fiber
calibrations). As the orders are already straightened we use just the localization coefficient value at the center of
the image to extract vertically along each order. We then divide the image by the order profile to provide a weighting
across the order (i.e., an optimal extraction, Horne et al. 1986}). The final step of the optimal extraction is to sum
vertically across the columns accounting for cosmic rays by using a sigma clip <span class="math notranslate nohighlight">\(|flux|&gt;10\sigma\)</span> away from the
median value for that column. This creates our <cite>E2DS</cite> (extracted 2D spectrum) and for SPIRou, this leads to images
with 49 orders and 4088 pixels along the orders.</p>
</section>
<section id="berv-correction">
<h4>BERV correction<a class="headerlink" href="#berv-correction" title="Permalink to this heading">¶</a></h4>
<p>Ideally, any stellar spectrum observed would be measured from a point stationary with respect to the barycenter of the
Solar System (Wright et al. 2014). However, ground-based observations are subject to: the orbit of the Earth, the
rotation of the Earth, precession and other Earth motions, and to a lesser extent gravitation time dilation,
leap-second offsets, and factors affecting the star itself (i.e., parallax, proper motions, etc). We use the term BERV
(Barycentric Earth Radial Velocity) hereinafter to collect all these terms into a single measurement which can be used
to correct a specific spectrum at a specific point in time. We calculate the BERV using the barycorrpy package, which
uses the astrometric parameters fed in at the preprocessing level. The calculation from barycorrpy includes the
estimate for the BERV itself and the corrected or barycentric Julian Date (BJD) at the mid-exposure time. barycorrpy
has a precision better than the <span class="math notranslate nohighlight">\(cm s^{-1}\)</span> level. We also estimate the maximum BERV value for this object
across the year. If for any reason the BERV calculation fails with barycorrpy we calculate an estimate of the BERV
(precise to <span class="math notranslate nohighlight">\(\sim 10 m s^{-1}\)</span>, modified from PyAstronomy.pyasl.baryvel; a python implementation of helcorr)
and flag that an estimated BERV correction was calculated. This estimated BERV is not precise enough for PRV work but
is sufficient to allow for acceptable telluric correction.</p>
</section>
<section id="leak-correction">
<h4>Leak Correction<a class="headerlink" href="#leak-correction" title="Permalink to this heading">¶</a></h4>
<p>For scientific observations, the reference fiber either has a DARK or an FP illuminating the pixels in this fiber.
For PRV an FP allows a simultaneous RV measurement of an FP alongside the measurement of the stellar RV; this allows
precise tracking of the instrumental drift when the simultaneous FP is compared to the <cite>FP_FP</cite> from the nightly
wavelength solution calibration. However, light from the FP has been shown to slightly contaminate the science fibers
and thus we provide a correction for such calibration.</p>
<p>During the reference sequence  many <cite>DARK_FP</cite> are combined (and extracted) to form a model of the light seen in the
science fibers when no light (other than the contribution from the DARK) was present as well as an extracted reference
fiber measurement of the FP flux that caused said contamination in the science fibers. Using these models, the
contamination measured in the science channels of the reference leak recipe is then scaled to the flux of the
simultaneous FP of the observation (using the extracted flux from this scientific observation we are trying to correct).
Then, this model is subtracted from the original science observation for each of the science fibers (AB or A or B),
order-by-order:</p>
<div class="math notranslate nohighlight">
\[ratio_{i} = \frac{\Sigma(L[C]_{i}S[C]_{i})}{\Sigma(S[C]_{i}^2)}\]</div>
<div class="math notranslate nohighlight">
\[scale_{i} = \frac{L[AB,A,B]_{i}}{ratio_{i}}\]</div>
<div class="math notranslate nohighlight">
\[S[AB,A,B]_{i,corr} = S[AB,A,B]_{i} - scale_{i}\]</div>
<p>where L[C] is the model of the FP from the leak reference recipe, S[C] is the 2D extracted spectrum in the reference
fiber (fiber C), L[AB,A,B] is the model of the contamination from the FP from the leak reference recipe in the science
fibers (either AB or A or B), S[AB,A,B] is the 2D extracted flux in the science fibers (either AB or A or B),
S[AB,A,B]_{corr} denotes the leak-corrected 2D extracted spectrum in the science fibers (either AB or A or B) and
i denotes that this is done order-by-order.</p>
</section>
<section id="thermal-correction">
<h4>Thermal correction<a class="headerlink" href="#thermal-correction" title="Permalink to this heading">¶</a></h4>
<p>The reference dark, applied during the standard image calibration phase, removes the high-frequency components of the
dark; however, the thermal contribution still remains (and varies on a night-by-night basis). For this reason, we use
nightly extracted <cite>DARK_DARK</cite> files to model the thermal contribution present in an observation during the night.
The thermal correction model comes in two flavors, one for science observations where we assume there is some sort of
continuum to the spectrum and telluric contamination as well as a small contribution arising from the Earth’s
atmosphere itself, and one for HC or FP extractions where these assumptions are not true.</p>
<p>In the case where we have a scientific observation, a <cite>DARK_DARK_TEL</cite> (where the calibration fiber sees the cold source
and the science fibers see the mirror covers) is used. The extracted <cite>DARK_DARK_TEL</cite>  is then median filtered with a
width of 101 pixels (on a per-order basis). This width was chosen to be big enough to capture large-scale structures
in the dark and not be significantly affected by readout noise. A fit is then made to the red most orders
(<span class="math notranslate nohighlight">\(&gt;2450 nm\)</span>) using only flux lower than 0.01 from a transmission spectrum from the Transmissions of the
AtmosPhere for AStromomical data tool (TAPAS) – i.e., a domain where transmission is basically zero. We assume that
we can safely use any flux with a transmission of order zero to scale the thermal background to this zero transmission
value.</p>
<div class="math notranslate nohighlight">
\[\begin{split}mask = \left\{ \begin{array}{cl}
1: &amp; TAPAS &lt; 0.01  \\
0: &amp; \text{otherwise} \\
\end{array} \right. \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[ratio = median\left( \frac{TT[AB,A,B,C]\times mask}{S[AB,A,B,C] \times mask} \right)\]</div>
<div class="math notranslate nohighlight">
\[S[AB,A,B,C]_{corr} = S[AB,A,B,C] - \frac{TT[AB,A,B,C]}{ratio}\]</div>
<p>where TAPAS is the TAPAS spectrum, TT[AB,A,B,C] is a nightly extracted <cite>DARK_DARK_TEL</cite> spectrum, S[AB,A,B,C] denotes
the 2D extracted spectrum prior to correction and <span class="math notranslate nohighlight">\(S[AB,A,B]_{corr}\)</span> denotes the thermally corrected 2D extracted
spectrum.</p>
<p>In the case where we have an HC or an FP observation, a <cite>DARK_DARK_INT</cite> (where all three fibers see only the cold source,
not the sky nor the mirror covers) is used. The extracted <cite>DARK_DARK_INT</cite> is then median filtered (again with a width
of 101 pixels on a per-order basis) and a fit is made using an envelope to measure the thermal background in the
reddest orders (<span class="math notranslate nohighlight">\(&gt;2450\, nm\)</span>). The envelope is constructed by using the flux below the 10th percentile (i.e.,
not in the HC or FP peaks). This is then converted into a ratio and scaled to the observation we are correcting.</p>
<div class="math notranslate nohighlight">
\[ratio = median\left( \frac{TI[AB,A,B,C]}{P_{10}(TI[AB,A,B,C])} \right)\]</div>
<div class="math notranslate nohighlight">
\[S[AB,A,B,C]_{corr} = S[AB,A,B,C] - \frac{TI[AB,A,B,C]}{ratio}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{10}\)</span> is the 10th percentile value, TI[AB,A,B,C] is a nightly extracted <cite>DARK_DARK_INT</cite> spectrum
(median filtered with a width of 101 pixels), S[AB,A,B,C] denotes the 2D extracted spectrum prior to correction and
<span class="math notranslate nohighlight">\(S[AB,A,B]_{corr}\)</span> denotes the thermally corrected 2D extracted spectrum.</p>
</section>
<section id="s1d-generation">
<h4>S1D generation<a class="headerlink" href="#s1d-generation" title="Permalink to this heading">¶</a></h4>
<p>The <cite>E2DS</cite> and <cite>E2DSFF</cite> formats are not necessarily the most convenient for science analysis, having duplicated
wavelength coverage at order overlap and slightly varying velocity sampling with each order and between orders.
We therefore transform the <cite>E2DSFF</cite> file into the <cite>S1D</cite> format. The <cite>S1D</cite> is sampled on a constant grid for all
objects. We have two differing <cite>S1D</cite> formats, one with a uniform step in wavelength (0.05 nm/pixel) and one with a
constant step in velocity (1 <span class="math notranslate nohighlight">\(km s^{-1}\)</span>/pixel), both being sampled between 965 nm and 2500 nm. Numerically,
to construct the <cite>S1D</cite>, we use as an input the <cite>E2DSFF</cite> file prior to blaze correction and the blaze file as inputs.
We create two <cite>S1D</cite> vectors, one corresponding to the total flux and one corresponding to the total blaze on the
destination wavelength grid. We use a 5th order polynomial spline to project the flux of a given order onto the flux
grid and perform the same operation with the blaze onto the weight vector. We do not consider the blaze below 20% of
the peak blaze value and values on the destination wavelength grids that are out of the order’s range are set to zero.
We loop through orders and sum the contribution of each order onto the respective destination grids for the <cite>E2DSFF</cite>
science flux and blaze. Note that the <cite>S1D</cite> generation only depends on the blaze calibration. As such any spectrum
(regardless of emission lines, low flux, or strong bands) can be converted to <cite>S1D</cite> format and we generate <cite>S1D</cite> for
<cite>HC_HC</cite> and <cite>FP_FP</cite> as well as science targets.</p>
</section>
</section>
</section>
<section id="schematic">
<h2>2. Schematic<a class="headerlink" href="#schematic" title="Permalink to this heading">¶</a></h2>
<p>No schematic set</p>
</section>
<section id="usage">
<h2>3. Usage<a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apero_extract_spirou</span><span class="o">.</span><span class="n">py</span> <span class="p">{</span><span class="n">obs_dir</span><span class="p">}[</span><span class="n">STRING</span><span class="p">]</span> <span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">DRS_PP</span><span class="p">]</span> <span class="p">{</span><span class="n">options</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">obs_dir</span><span class="p">}[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">OBS_DIR_HELP</span>
<span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">DRS_PP</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="o">/</span><span class="n">STRINGS</span><span class="p">]</span> <span class="n">A</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">fits</span> <span class="n">files</span> <span class="n">to</span> <span class="n">use</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">spaces</span><span class="o">.</span> <span class="n">Current</span> <span class="n">accepts</span> <span class="nb">all</span> <span class="n">preprocessed</span> <span class="n">filetypes</span><span class="o">.</span> <span class="n">All</span> <span class="n">files</span> <span class="n">used</span> <span class="n">will</span> <span class="n">be</span> <span class="n">combined</span> <span class="n">into</span> <span class="n">a</span> <span class="n">single</span> <span class="n">frame</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="optional-arguments">
<h2>4. Optional Arguments<a class="headerlink" href="#optional-arguments" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">quicklook</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">whether</span> <span class="n">extraction</span> <span class="n">done</span> <span class="ow">in</span> <span class="n">quick</span> <span class="n">look</span> <span class="n">mode</span>
<span class="o">--</span><span class="n">badpixfile</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">BADPIX</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Define</span> <span class="n">a</span> <span class="n">custom</span> <span class="n">file</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">bad</span> <span class="n">pixel</span> <span class="n">correction</span><span class="o">.</span> <span class="n">Checks</span> <span class="k">for</span> <span class="n">an</span> <span class="n">absolute</span> <span class="n">path</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">checks</span> <span class="n">directory</span>
<span class="o">--</span><span class="n">badcorr</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">correct</span> <span class="k">for</span> <span class="n">the</span> <span class="n">bad</span> <span class="n">pixel</span> <span class="n">file</span>
<span class="o">--</span><span class="n">backsub</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">do</span> <span class="n">background</span> <span class="n">subtraction</span>
<span class="o">--</span><span class="n">blazefile</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">FF_BLAZE</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Define</span> <span class="n">a</span> <span class="n">custom</span> <span class="n">file</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">blaze</span> <span class="n">correction</span><span class="o">.</span> <span class="n">If</span> <span class="n">unset</span> <span class="n">uses</span> <span class="n">closest</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">calibDB.</span> <span class="n">Checks</span> <span class="k">for</span> <span class="n">an</span> <span class="n">absolute</span> <span class="n">path</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">checks</span> <span class="n">directory</span> <span class="p">(</span><span class="n">CALIBDB</span><span class="o">=</span><span class="n">BADPIX</span><span class="p">)</span>
<span class="o">--</span><span class="n">combine</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">combine</span> <span class="n">fits</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">file</span> <span class="nb">list</span> <span class="ow">or</span> <span class="n">to</span> <span class="n">process</span> <span class="n">them</span> <span class="n">separately</span>
<span class="o">--</span><span class="n">combine_method</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Method</span> <span class="n">to</span> <span class="n">combine</span> <span class="n">files</span> <span class="p">(</span><span class="k">if</span> <span class="o">--</span><span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">--</span><span class="n">objname</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Sets</span> <span class="n">the</span> <span class="nb">object</span> <span class="n">name</span> <span class="n">to</span> <span class="n">extract</span> <span class="p">(</span><span class="n">filters</span> <span class="nb">input</span> <span class="n">files</span><span class="p">)</span>
<span class="o">--</span><span class="n">dprtype</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">DPRTYPE</span> <span class="n">to</span> <span class="n">extract</span> <span class="p">(</span><span class="n">filters</span> <span class="nb">input</span> <span class="n">files</span><span class="p">)</span>
<span class="o">--</span><span class="n">darkfile</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">DARKREF</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">The</span> <span class="n">Dark</span> <span class="n">file</span> <span class="n">to</span> <span class="n">use</span> <span class="p">(</span><span class="n">CALIBDB</span><span class="o">=</span><span class="n">DARKM</span><span class="p">)</span>
<span class="o">--</span><span class="n">darkcorr</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">correct</span> <span class="k">for</span> <span class="n">the</span> <span class="n">dark</span> <span class="n">file</span>
<span class="o">--</span><span class="n">fiber</span><span class="p">[</span><span class="n">ALL</span><span class="p">,</span><span class="n">AB</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Define</span> <span class="n">which</span> <span class="n">fibers</span> <span class="n">to</span> <span class="n">extract</span>
<span class="o">--</span><span class="n">flipimage</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">both</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">flip</span> <span class="n">fits</span> <span class="n">image</span>
<span class="o">--</span><span class="n">fluxunits</span><span class="p">[</span><span class="n">ADU</span><span class="o">/</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="o">-</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Output</span> <span class="n">units</span> <span class="k">for</span> <span class="n">flux</span>
<span class="o">--</span><span class="n">flatfile</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">FF_FLAT</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Define</span> <span class="n">a</span> <span class="n">custom</span> <span class="n">file</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">flat</span> <span class="n">correction</span><span class="o">.</span> <span class="n">If</span> <span class="n">unset</span> <span class="n">uses</span> <span class="n">closest</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">calibDB.</span> <span class="n">Checks</span> <span class="k">for</span> <span class="n">an</span> <span class="n">absolute</span> <span class="n">path</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">checks</span> <span class="n">directory</span>
<span class="o">--</span><span class="n">locofile</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">LOC_LOCO</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">LOCO</span> <span class="n">file</span> <span class="n">used</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">coefficients</span> <span class="p">(</span><span class="n">CALIBDB</span><span class="o">=</span><span class="n">LOC_</span><span class="p">{</span><span class="n">fiber</span><span class="p">})</span>
<span class="o">--</span><span class="n">orderpfile</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">LOC_ORDERP</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">Order</span> <span class="n">Profile</span> <span class="n">file</span> <span class="n">used</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">coefficients</span> <span class="p">(</span><span class="n">CALIBDB</span><span class="o">=</span><span class="n">ORDER_PROFILE_</span><span class="p">{</span><span class="n">fiber</span><span class="p">}</span>
<span class="o">--</span><span class="n">plot</span><span class="p">[</span><span class="mi">0</span><span class="o">&gt;</span><span class="n">INT</span><span class="o">&gt;</span><span class="mi">4</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">INTEGER</span><span class="p">]</span> <span class="n">Plot</span> <span class="n">level</span><span class="o">.</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">off</span><span class="p">,</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">interactively</span><span class="p">,</span> <span class="mi">2</span> <span class="o">=</span> <span class="n">save</span> <span class="n">to</span> <span class="n">file</span>
<span class="o">--</span><span class="n">resize</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">resize</span> <span class="n">image</span>
<span class="o">--</span><span class="n">shapex</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">SHAPE_X</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">SHAPE</span> <span class="n">DXMAP</span> <span class="n">file</span> <span class="n">used</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">dx</span> <span class="n">correction</span> <span class="nb">map</span> <span class="p">(</span><span class="n">CALIBDB</span><span class="o">=</span><span class="n">SHAPEX</span><span class="p">)</span>
<span class="o">--</span><span class="n">shapey</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">SHAPE_Y</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">SHAPE</span> <span class="n">DYMAP</span> <span class="n">file</span> <span class="n">used</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">dy</span> <span class="n">correction</span> <span class="nb">map</span> <span class="p">(</span><span class="n">CALIBDB</span><span class="o">=</span><span class="n">SHAPEY</span><span class="p">)</span>
<span class="o">--</span><span class="n">shapel</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">SHAPEL</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">SHAPE</span> <span class="n">local</span> <span class="n">file</span> <span class="n">used</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">local</span> <span class="n">transforms</span> <span class="p">(</span><span class="n">CALIBDB</span> <span class="o">=</span> <span class="n">SHAPEL</span><span class="p">)</span>
<span class="o">--</span><span class="n">leakcorr</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">whether</span> <span class="n">to</span> <span class="n">do</span> <span class="n">the</span> <span class="n">leak</span> <span class="n">correction</span> <span class="p">(</span><span class="k">else</span> <span class="n">defaults</span> <span class="n">to</span> <span class="n">CORRECT_LEAKAGE</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">constants</span><span class="p">)</span>
<span class="o">--</span><span class="n">thermal</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">whether</span> <span class="n">to</span> <span class="n">do</span> <span class="n">the</span> <span class="n">thermal</span> <span class="n">correction</span> <span class="p">(</span><span class="k">else</span> <span class="n">defaults</span> <span class="n">to</span> <span class="n">THERMAL_CORRECT</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">constants</span><span class="p">)</span>
<span class="o">--</span><span class="n">thermalfile</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">THERMALI_E2DS</span><span class="p">,</span><span class="n">THERMALT_E2DS</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">Thermal</span> <span class="n">correction</span> <span class="n">file</span> <span class="n">to</span> <span class="n">use</span> <span class="p">(</span><span class="n">CAILBDB</span> <span class="o">=</span> <span class="n">THERMAL_</span><span class="p">{</span><span class="n">fiber</span><span class="p">})</span>
<span class="o">--</span><span class="n">wavefile</span><span class="p">[</span><span class="n">FILE</span><span class="p">:</span><span class="n">WAVESOL_REF</span><span class="p">,</span><span class="n">WAVE_NIGHT</span><span class="p">,</span><span class="n">WAVESOL_DEFAULT</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Define</span> <span class="n">a</span> <span class="n">custom</span> <span class="n">file</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">the</span> <span class="n">wave</span> <span class="n">solution</span><span class="o">.</span> <span class="n">If</span> <span class="n">unset</span> <span class="n">uses</span> <span class="n">closest</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">header</span> <span class="ow">or</span> <span class="n">calibDB</span> <span class="p">(</span><span class="n">depending</span> <span class="n">on</span> <span class="n">setup</span><span class="p">)</span><span class="o">.</span> <span class="n">Checks</span> <span class="k">for</span> <span class="n">an</span> <span class="n">absolute</span> <span class="n">path</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">checks</span> <span class="n">directory</span>
<span class="o">--</span><span class="n">force_ref_wave</span><span class="p">[</span><span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">]</span> <span class="o">//</span> <span class="n">Force</span> <span class="n">using</span> <span class="n">the</span> <span class="n">reference</span> <span class="n">wave</span> <span class="n">solution</span>
<span class="o">--</span><span class="n">no_in_qc</span> <span class="o">//</span> <span class="n">Disable</span> <span class="n">checking</span> <span class="n">the</span> <span class="n">quality</span> <span class="n">control</span> <span class="n">of</span> <span class="nb">input</span> <span class="n">files</span>
</pre></div>
</div>
</section>
<section id="special-arguments">
<h2>5. Special Arguments<a class="headerlink" href="#special-arguments" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">xhelp</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Extended</span> <span class="n">help</span> <span class="n">menu</span> <span class="p">(</span><span class="k">with</span> <span class="nb">all</span> <span class="n">advanced</span> <span class="n">arguments</span><span class="p">)</span>
<span class="o">--</span><span class="n">debug</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Activates</span> <span class="n">debug</span> <span class="n">mode</span> <span class="p">(</span><span class="n">Advanced</span> <span class="n">mode</span> <span class="p">[</span><span class="n">INTEGER</span><span class="p">]</span> <span class="n">value</span> <span class="n">must</span> <span class="n">be</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">greater</span> <span class="n">than</span> <span class="mi">0</span><span class="p">,</span> <span class="n">setting</span> <span class="n">the</span> <span class="n">debug</span> <span class="n">level</span><span class="p">)</span>
<span class="o">--</span><span class="n">listing</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Lists</span> <span class="n">the</span> <span class="n">night</span> <span class="n">name</span> <span class="n">directories</span> <span class="ow">in</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">directory</span> <span class="k">if</span> <span class="n">used</span> <span class="n">without</span> <span class="n">a</span> <span class="s1">&#39;directory&#39;</span> <span class="n">argument</span> <span class="ow">or</span> <span class="n">lists</span> <span class="n">the</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">given</span> <span class="s1">&#39;directory&#39;</span> <span class="p">(</span><span class="k">if</span> <span class="n">defined</span><span class="p">)</span><span class="o">.</span> <span class="n">Only</span> <span class="n">lists</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">15</span> <span class="n">files</span><span class="o">/</span><span class="n">directories</span>
<span class="o">--</span><span class="n">listingall</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Lists</span> <span class="n">ALL</span> <span class="n">the</span> <span class="n">night</span> <span class="n">name</span> <span class="n">directories</span> <span class="ow">in</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">directory</span> <span class="k">if</span> <span class="n">used</span> <span class="n">without</span> <span class="n">a</span> <span class="s1">&#39;directory&#39;</span> <span class="n">argument</span> <span class="ow">or</span> <span class="n">lists</span> <span class="n">the</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">given</span> <span class="s1">&#39;directory&#39;</span> <span class="p">(</span><span class="k">if</span> <span class="n">defined</span><span class="p">)</span>
<span class="o">--</span><span class="n">version</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Displays</span> <span class="n">the</span> <span class="n">current</span> <span class="n">version</span> <span class="n">of</span> <span class="n">this</span> <span class="n">recipe</span><span class="o">.</span>
<span class="o">--</span><span class="n">info</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Displays</span> <span class="n">the</span> <span class="n">short</span> <span class="n">version</span> <span class="n">of</span> <span class="n">the</span> <span class="n">help</span> <span class="n">menu</span>
<span class="o">--</span><span class="n">program</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">The</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">program</span> <span class="n">to</span> <span class="n">display</span> <span class="ow">and</span> <span class="n">use</span> <span class="p">(</span><span class="n">mostly</span> <span class="k">for</span> <span class="n">logging</span> <span class="n">purpose</span><span class="p">)</span> <span class="n">log</span> <span class="n">becomes</span> <span class="n">date</span> <span class="o">|</span> <span class="p">{</span><span class="n">THIS</span> <span class="n">STRING</span><span class="p">}</span> <span class="o">|</span> <span class="n">Message</span>
<span class="o">--</span><span class="n">recipe_kind</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">The</span> <span class="n">recipe</span> <span class="n">kind</span> <span class="k">for</span> <span class="n">this</span> <span class="n">recipe</span> <span class="n">run</span> <span class="p">(</span><span class="n">normally</span> <span class="n">only</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">apero_processing</span><span class="o">.</span><span class="n">py</span><span class="p">)</span>
<span class="o">--</span><span class="n">parallel</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOL</span><span class="p">]</span> <span class="n">If</span> <span class="kc">True</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">parellel</span> <span class="o">-</span> <span class="n">disable</span> <span class="n">some</span> <span class="n">features</span> <span class="p">(</span><span class="n">normally</span> <span class="n">only</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">apero_processing</span><span class="o">.</span><span class="n">py</span><span class="p">)</span>
<span class="o">--</span><span class="n">shortname</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Set</span> <span class="n">a</span> <span class="n">shortname</span> <span class="k">for</span> <span class="n">a</span> <span class="n">recipe</span> <span class="n">to</span> <span class="n">distinguish</span> <span class="n">it</span> <span class="kn">from</span> <span class="nn">other</span> <span class="n">runs</span> <span class="o">-</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">mainly</span> <span class="k">for</span> <span class="n">use</span> <span class="k">with</span> <span class="n">apero</span> <span class="n">processing</span> <span class="n">but</span> <span class="n">will</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">log</span> <span class="n">database</span>
<span class="o">--</span><span class="n">idebug</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">BOOLEAN</span><span class="p">]</span> <span class="n">If</span> <span class="kc">True</span> <span class="n">always</span> <span class="n">returns</span> <span class="n">to</span> <span class="n">ipython</span> <span class="p">(</span><span class="ow">or</span> <span class="n">python</span><span class="p">)</span> <span class="n">at</span> <span class="n">end</span> <span class="p">(</span><span class="n">via</span> <span class="n">ipdb</span> <span class="ow">or</span> <span class="n">pdb</span><span class="p">)</span>
<span class="o">--</span><span class="n">ref</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">If</span> <span class="nb">set</span> <span class="n">then</span> <span class="n">recipe</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">reference</span> <span class="n">recipe</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">reference</span> <span class="n">recipes</span> <span class="n">write</span> <span class="n">to</span> <span class="n">calibration</span> <span class="n">database</span> <span class="k">as</span> <span class="n">reference</span> <span class="n">calibrations</span><span class="p">)</span>
<span class="o">--</span><span class="n">crunfile</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Set</span> <span class="n">a</span> <span class="n">run</span> <span class="n">file</span> <span class="n">to</span> <span class="n">override</span> <span class="n">default</span> <span class="n">arguments</span>
<span class="o">--</span><span class="n">quiet</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Run</span> <span class="n">recipe</span> <span class="n">without</span> <span class="n">start</span> <span class="n">up</span> <span class="n">text</span>
<span class="o">--</span><span class="n">nosave</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="n">Do</span> <span class="ow">not</span> <span class="n">save</span> <span class="nb">any</span> <span class="n">outputs</span> <span class="p">(</span><span class="n">debug</span><span class="o">/</span><span class="n">information</span> <span class="n">run</span><span class="p">)</span><span class="o">.</span> <span class="n">Note</span> <span class="n">some</span> <span class="n">recipes</span> <span class="n">require</span> <span class="n">other</span> <span class="n">recipesto</span> <span class="n">be</span> <span class="n">run</span><span class="o">.</span> <span class="n">Only</span> <span class="n">use</span> <span class="o">--</span><span class="n">nosave</span> <span class="n">after</span> <span class="n">previous</span> <span class="n">recipe</span> <span class="n">runs</span> <span class="n">have</span> <span class="n">been</span> <span class="n">run</span> <span class="n">successfully</span> <span class="n">at</span> <span class="n">least</span> <span class="n">once</span><span class="o">.</span>
<span class="o">--</span><span class="n">force_indir</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Force</span> <span class="n">the</span> <span class="n">default</span> <span class="nb">input</span> <span class="n">directory</span> <span class="p">(</span><span class="n">Normally</span> <span class="nb">set</span> <span class="n">by</span> <span class="n">recipe</span><span class="p">)</span>
<span class="o">--</span><span class="n">force_outdir</span><span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="o">//</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span> <span class="n">Force</span> <span class="n">the</span> <span class="n">default</span> <span class="n">output</span> <span class="n">directory</span> <span class="p">(</span><span class="n">Normally</span> <span class="nb">set</span> <span class="n">by</span> <span class="n">recipe</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="output-directory">
<h2>6. Output directory<a class="headerlink" href="#output-directory" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DRS_DATA_REDUC</span> <span class="o">//</span> <span class="n">Default</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span> <span class="n">directory</span>
</pre></div>
</div>
</section>
<section id="output-files">
<h2>7. Output files<a class="headerlink" href="#output-files" title="Permalink to this heading">¶</a></h2>
<table class="csvtable docutils align-default" id="id1">
<caption><span class="caption-text">Outputs</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>description</p></th>
<th class="head"><p>HDR[DRSOUTID]</p></th>
<th class="head"><p>file type</p></th>
<th class="head"><p>suffix</p></th>
<th class="head"><p>fibers</p></th>
<th class="head"><p>input file</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EXT_E2DS</p></td>
<td><p>Extracted 2D spectrum</p></td>
<td><p>EXT_E2DS</p></td>
<td><p>.fits</p></td>
<td><p>_e2ds</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>DRS_PP</p></td>
</tr>
<tr class="row-odd"><td><p>EXT_E2DS_FF</p></td>
<td><p>Extracted + flat-fielded 2D spectrum</p></td>
<td><p>EXT_E2DS_FF</p></td>
<td><p>.fits</p></td>
<td><p>_e2dsff</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>DRS_PP</p></td>
</tr>
<tr class="row-even"><td><p>EXT_E2DS_LL</p></td>
<td><p>Pre-extracted straighted stacked spectrum</p></td>
<td><p>EXT_E2DS_LL</p></td>
<td><p>.fits</p></td>
<td><p>_e2dsll</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>DRS_PP, FLAT_FLAT</p></td>
</tr>
<tr class="row-odd"><td><p>EXT_S1D_W</p></td>
<td><p>1D stitched spectrum (constant wavelength binning)</p></td>
<td><p>EXT_S1D_W</p></td>
<td><p>.fits</p></td>
<td><p>_s1d_w</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>DRS_PP</p></td>
</tr>
<tr class="row-even"><td><p>EXT_S1D_V</p></td>
<td><p>1D stitched spectrum (constant velocity binning)</p></td>
<td><p>EXT_S1D_V</p></td>
<td><p>.fits</p></td>
<td><p>_s1d_v</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>DRS_PP</p></td>
</tr>
<tr class="row-odd"><td><p>ORDERP_STRAIGHT</p></td>
<td><p>Straightened order profile for an individual image</p></td>
<td><p>ORDERP_STRAIGHT</p></td>
<td><p>.fits</p></td>
<td><p>_orderps</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>SHAPEL</p></td>
</tr>
<tr class="row-even"><td><p>DEBUG_BACK</p></td>
<td><p>Individual file background map</p></td>
<td><p>DEBUG_BACK</p></td>
<td><p>.fits</p></td>
<td><p>_background.fits</p></td>
<td><p>–</p></td>
<td><p>DRS_PP</p></td>
</tr>
<tr class="row-odd"><td><p>EXT_FPLIST</p></td>
<td><p>FP lines identified from extracted FP fiber</p></td>
<td><p>EXT_FPLIST</p></td>
<td><p>.fits</p></td>
<td><p>_ext_fplines</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>EXT_E2DS, EXT_E2DS_FF</p></td>
</tr>
<tr class="row-even"><td><p>QL_E2DS</p></td>
<td><p>Extracted 2D spectrum (quick output)</p></td>
<td><p>QL_E2DS</p></td>
<td><p>.fits</p></td>
<td><p>_q2ds</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>DRS_PP</p></td>
</tr>
<tr class="row-odd"><td><p>QL_E2DS_FF</p></td>
<td><p>Extracted + flat-fielded 2D spectrum (quick output)</p></td>
<td><p>QL_E2DS_FF</p></td>
<td><p>.fits</p></td>
<td><p>_q2dsff</p></td>
<td><p>AB, A, B, C</p></td>
<td><p>DRS_PP</p></td>
</tr>
</tbody>
</table>
</section>
<section id="debug-plots">
<h2>8. Debug plots<a class="headerlink" href="#debug-plots" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FLAT_ORDER_FIT_EDGES1</span>
<span class="n">FLAT_ORDER_FIT_EDGES2</span>
<span class="n">FLAT_BLAZE_ORDER1</span>
<span class="n">FLAT_BLAZE_ORDER2</span>
<span class="n">THERMAL_BACKGROUND</span>
<span class="n">EXTRACT_SPECTRAL_ORDER1</span>
<span class="n">EXTRACT_SPECTRAL_ORDER2</span>
<span class="n">EXTRACT_S1D</span>
<span class="n">EXTRACT_S1D_WEIGHT</span>
<span class="n">WAVEREF_EXPECTED</span>
</pre></div>
</div>
</section>
<section id="summary-plots">
<h2>9. Summary plots<a class="headerlink" href="#summary-plots" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SUM_FLAT_ORDER_FIT_EDGES</span>
<span class="n">SUM_EXTRACT_SP_ORDER</span>
<span class="n">SUM_EXTRACT_S1D</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="rdefinition_WAVEREF.html" title="apero_wave_ref_spirou"
             >next</a> |</li>
        <li class="right" >
          <a href="rdefinition_LEAKREF.html" title="apero_leak_ref_spirou"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">APERO 0.8.001 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../main/spirou/main_spirou.html" >SPIRou documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="recipes.html" >Recipes (SPIROU)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">apero_extract_spirou</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Neil Cook.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>