


<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Nightly wavelength solution calibration &#8212; APERO 0.8.001 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bizstyle.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/apero.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="_static/images/fonta/css/font-awesome.min.css">



    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
    <style>
      table.right { float: left; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script>
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">

  <ul>
    <li><a title="Home" href="../../../index.html">
        <i class="fa fa-home fa-3x" aria-hidden="true"></i></a></li>
    <li><a title="install" href="../../../user/general/installation.html">
        <i class="fa fa-cog fa-3x" aria-hidden="true"></i></a></li>
    <li><a title="github" href="https://github.com/njcuk9999/apero-drs">
        <i class="fa fa-git-square fa-3x" aria-hidden="true"></i></a></li>
    <li><a title="download pdf" href="../../../apero-docs.pdf">
        <i class="fa fa-download fa-3x" aria-hidden="true"></i></a></li>
    <li><a title="UdeM" href="/main/misc/udem.html">
        <i class="fa fa-university fa-3x" aria-hidden="true"></i></a></li>
  </ul>
    <div>
    <a href="../../../index.html">
      <img src="../../../_static/images/apero_logo.png" alt="APERO" />
    </a>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A PipelinE to Reduce Observations
    </div>

</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">APERO 0.8.001 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Nightly wavelength solution calibration</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/resources/spirou/descriptions/apero_wave_night_spirou.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="nightly-wavelength-solution-calibration">
<h1>Nightly wavelength solution calibration<a class="headerlink" href="#nightly-wavelength-solution-calibration" title="Permalink to this heading">Â¶</a></h1>
<p>Considering that the wavelength solution is central in the anchoring of PRV measurement and that the instrument will
drift through time, one needs to obtain a wavelength solution as close as possible in time to the science exposures,
ideally on a nightly basis. The nightly wavelength solution captures sub-<span class="math notranslate nohighlight">\(\mu m\)</span> level motions within the
optical train and high-order changes in the focal plane that are not captured by the affine transform used to
register frames as described in sections ref{subsec:ref_shape} and ref{subsec:night_shape}. The nightly wavelength
solution recipe takes preprocessed <cite>FP_FP</cite> files and <cite>HC_HC</cite> files (as many as given by the user or as many as occur on
each of the nights being used via <cite>apero_processing</cite>). It combines the <cite>FP_FP</cite> and  <cite>HC_HC</cite> files into a single`FP_FP`
and a single <cite>HC_HC</cite> file (via a median combination of the images). These combined <cite>FP_FP</cite> and <cite>HC_HC</cite> files are then
extracted.</p>
<p>The rest of the process is similar to the reference wavelength solution. The wavelength solution is determined as
follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>Under the assumption that the reference wavelength solution is correct at the pixel level, identify HC lines
(catalog wavelength) and FP peaks (FP order).</p></li>
<li><p>By combining the reference chromatic FP cavity length and position of FP peaks of known FP order,  fit a
per-order wavelength solution.</p></li>
<li><p>Using that wavelength solution, measure the velocity offset in the position of HC lines
(<span class="math notranslate nohighlight">\(\Delta v_{\rm HC}\)</span>) and derive an achromatic increment to be applied to the FP cavity</p></li>
<li><p>Scale the 0th order term of the Nth order cavity polynomial by <span class="math notranslate nohighlight">\(1-\frac{\Delta v_{\rm HC}}{c}\)</span>, where c
is the speed of light in the units of <span class="math notranslate nohighlight">\(\Delta v_{\rm HC}\)</span>.</p></li>
<li><p>Iterate the last two steps until <span class="math notranslate nohighlight">\(\Delta v_{\rm HC}\)</span> is consistent with zero.</p></li>
</ul>
</div></blockquote>
<p>The main difference with the reference wavelength solution for fiber AB is that while we start the calculation of the
wavelength solution with the cavity fit and wavelength solution from the reference wavelength solution calibration,
we only allow for changes in the achromatic term. This is because the chromatic dependence of the cavity width is
related to the coating of the FP etalon, and is therefore not expected to change rapidly. An achromatic shift, on the
other hand, corresponds to a change in the cavity length of the FP, due in part to pressure or temperature variations,
which may happen between nights. Meanwhile, for fibers A, B, and C we fit nothing and use the fiber AB wavelength
cavity coefficients. The FP mask for quality control is also not re-generated. Therefore all cross-correlations
between fibers AB and A, B, and C are done relative to the reference night wavelength solution (however we only check
quality control on <span class="math notranslate nohighlight">\(AB-A\)</span>, <span class="math notranslate nohighlight">\(AB-B\)</span>, <span class="math notranslate nohighlight">\(AB-C\)</span>). As with the reference wavelength solution recipe, a
wavelength solution for each fiber, and the FP and HC lines founds during the process, are then saved to the
calibration database for use throughout APERO.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">APERO 0.8.001 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Nightly wavelength solution calibration</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Neil Cook.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>