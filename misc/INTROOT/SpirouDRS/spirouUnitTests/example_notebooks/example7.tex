
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{example7}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Using the calibration
database}\label{using-the-calibration-database}

The calibration database is an important part of the DRS.

\subsection{Loading the calibration database (with unique entries for
each
key)}\label{loading-the-calibration-database-with-unique-entries-for-each-key}

By default the calibration database should be opened in the setup
procedure of the recipe.

For this to happen it requires an acquisition time (to make a choice
between the calibration database files).

Therefore during setup a file must be marked as the main fits file.

This is done by default is using the standard recipe options (i.e.
RECIPE NIGHT\_NAME FILES) - the first file is used as the main fits file
(and therefore defines "fitsfilename")

For custom arguments one has to set this file name manually (using the
"mainfitsfile" arguement in "LoadArguments" where "mainfitsfile" must be
one of the names (see example 4). Also recall that if one uses custom
arguments one must manually load he calibration database
(\texttt{spirouStartup.LoadCalibDB(p)}).

Below we use cal\_loc\_RAW\_spirou.py as an example

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} notebook only setup run time arguments via sys.argv}
        \PY{k+kn}{import} \PY{n+nn}{sys}
        \PY{n}{sys}\PY{o}{.}\PY{n}{argv} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cal\PYZus{}loc\PYZus{}RAW\PYZus{}spirou.py 20170710 flat\PYZus{}dark02f10.fits flat\PYZus{}dark03f10.fits flat\PYZus{}dark04f10.fits }\PY{l+s+s1}{\PYZsq{}}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flat\PYZus{}dark05f10.fits flat\PYZus{}dark06f10.fits}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{} imports and setup}
        \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{division}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{os}
        
        \PY{k+kn}{from} \PY{n+nn}{SpirouDRS} \PY{k+kn}{import} \PY{n}{spirouBACK}
        \PY{k+kn}{from} \PY{n+nn}{SpirouDRS} \PY{k+kn}{import} \PY{n}{spirouCDB}
        \PY{k+kn}{from} \PY{n+nn}{SpirouDRS} \PY{k+kn}{import} \PY{n}{spirouConfig}
        \PY{k+kn}{from} \PY{n+nn}{SpirouDRS} \PY{k+kn}{import} \PY{n}{spirouCore}
        \PY{k+kn}{from} \PY{n+nn}{SpirouDRS} \PY{k+kn}{import} \PY{n}{spirouImage}
        \PY{k+kn}{from} \PY{n+nn}{SpirouDRS} \PY{k+kn}{import} \PY{n}{spirouLOCOR}
        \PY{k+kn}{from} \PY{n+nn}{SpirouDRS} \PY{k+kn}{import} \PY{n}{spirouStartup}
        
        \PY{c+c1}{\PYZsh{} =============================================================================}
        \PY{c+c1}{\PYZsh{} Define variables}
        \PY{c+c1}{\PYZsh{} =============================================================================}
        \PY{c+c1}{\PYZsh{} Get Logging function}
        \PY{n}{WLOG} \PY{o}{=} \PY{n}{spirouCore}\PY{o}{.}\PY{n}{wlog}
        \PY{c+c1}{\PYZsh{} Get plotting functions}
        \PY{n}{sPlt} \PY{o}{=} \PY{n}{spirouCore}\PY{o}{.}\PY{n}{sPlt}
        \PY{c+c1}{\PYZsh{} Name of program}
        \PY{n}{\PYZus{}\PYZus{}NAME\PYZus{}\PYZus{}} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cal\PYZus{}loc\PYZus{}RAW\PYZus{}spirou.py}\PY{l+s+s1}{\PYZsq{}}
        \PY{c+c1}{\PYZsh{} Get version and author}
        \PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}} \PY{o}{=} \PY{n}{spirouConfig}\PY{o}{.}\PY{n}{Constants}\PY{o}{.}\PY{n}{VERSION}\PY{p}{(}\PY{p}{)}
        \PY{n}{\PYZus{}\PYZus{}author\PYZus{}\PYZus{}} \PY{o}{=} \PY{n}{spirouConfig}\PY{o}{.}\PY{n}{Constants}\PY{o}{.}\PY{n}{AUTHORS}\PY{p}{(}\PY{p}{)}
        \PY{n}{\PYZus{}\PYZus{}date\PYZus{}\PYZus{}} \PY{o}{=} \PY{n}{spirouConfig}\PY{o}{.}\PY{n}{Constants}\PY{o}{.}\PY{n}{LATEST\PYZus{}EDIT}\PY{p}{(}\PY{p}{)}
        \PY{n}{\PYZus{}\PYZus{}release\PYZus{}\PYZus{}} \PY{o}{=} \PY{n}{spirouConfig}\PY{o}{.}\PY{n}{Constants}\PY{o}{.}\PY{n}{RELEASE}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} Custom parameter dictionary}
        \PY{n}{ParamDict} \PY{o}{=} \PY{n}{spirouConfig}\PY{o}{.}\PY{n}{ParamDict}
        
        \PY{c+c1}{\PYZsh{} calls to main function (missing here) and set to None to use run time arguments}
        \PY{n}{night\PYZus{}name} \PY{o}{=} \PY{n+nb+bp}{None}
        \PY{n}{files} \PY{o}{=} \PY{n+nb+bp}{None}
        
        \PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{c+c1}{\PYZsh{} Set up}
        \PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{c+c1}{\PYZsh{} get parameters from config files/run time args/load paths + calibdb}
        \PY{n}{p} \PY{o}{=} \PY{n}{spirouStartup}\PY{o}{.}\PY{n}{Begin}\PY{p}{(}\PY{p}{)}
        \PY{n}{p} \PY{o}{=} \PY{n}{spirouStartup}\PY{o}{.}\PY{n}{LoadArguments}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n}{night\PYZus{}name}\PY{p}{,} \PY{n}{files}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} run specific start up}
        \PY{n}{params2add} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}
        \PY{n}{params2add}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dark\PYZus{}flat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{spirouLOCOR}\PY{o}{.}\PY{n}{FiberParams}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{params2add}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flat\PYZus{}dark}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{spirouLOCOR}\PY{o}{.}\PY{n}{FiberParams}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{p} \PY{o}{=} \PY{n}{spirouStartup}\PY{o}{.}\PY{n}{InitialFileSetup}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{localisation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                           \PY{n}{prefixes}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dark\PYZus{}flat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flat\PYZus{}dark}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                           \PY{n}{add\PYZus{}to\PYZus{}p}\PY{o}{=}\PY{n}{params2add}\PY{p}{,} \PY{n}{calibdb}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   || *****************************************}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   || * SPIROU @(\#) Geneva Observatory (0.1.032)}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   || *****************************************}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(dir\_data\_raw)      DRS\_DATA\_RAW=/scratch/Projects/spirou\_py3/data/raw}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(dir\_data\_reduc)    DRS\_DATA\_REDUC=/scratch/Projects/spirou\_py3/data/reduced}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(dir\_calib\_db)      DRS\_CALIB\_DB=/scratch/Projects/spirou\_py3/data/calibDB}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(dir\_data\_msg)      DRS\_DATA\_MSG=/scratch/Projects/spirou\_py3/data/msg}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(print\_level)       PRINT\_LEVEL=all         \%(error/warning/info/all)}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(log\_level)         LOG\_LEVEL=all         \%(error/warning/info/all)}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(plot\_graph)        DRS\_PLOT=1            \%(def/undef/trigger)}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(used\_date)         DRS\_USED\_DATE=undefined}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||(working\_dir)       DRS\_DATA\_WORKING=/scratch/Projects/spirou\_py3/data/tmp}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   ||                    DRS\_INTERACTIVE is not set, running on-line mode}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Now running : cal\_loc\_RAW\_spirou on file(s): flat\_dark02f10.fits, flat\_dark03f10.fits, flat\_dark04f10.fits, flat\_dark05f10.fits, flat\_dark06f10.fits}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|On directory /scratch/Projects/spirou\_py3/data/raw/20170710}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|ICDP\_NAME loaded from: /scratch/Projects/spirou\_py3/spirou\_py3/INTROOT/config/constants\_SPIROU.py}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 - * |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Correct type of image for localisation (dark\_flat or flat\_dark)}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_flat\_flat02f10\_badpixel.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_flat\_dark02f10\_blaze\_AB.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_dark\_flat02f10\_blaze\_C.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_dark\_dark02d406.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_flat\_dark02f10\_flat\_AB.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_dark\_flat02f10\_flat\_C.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_flat\_dark02f10\_loco\_AB.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_dark\_flat02f10\_loco\_C.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_flat\_dark02f10\_order\_profile\_AB.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_dark\_flat02f10\_order\_profile\_C.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 20170710\_fp\_fp02a203\_tilt.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: spirou\_wave\_ini3.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 2017-10-11\_21-32-17\_hcone\_hcone02c406\_wave\_AB.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: spirou\_wave\_ini3.fits already exists - not copied}}
\textcolor{ansi-green-intense}{\textbf{15:38:55.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Calibration file: 2017-10-11\_21-32-17\_hcone\_hcone02c406\_wave\_C.fits already exists - not copied}}

    \end{Verbatim}

    As mentioned above the calibration database was loaded automatically
here:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{p}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{calibDB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} \{'BADPIX': ['20170710', '20170710\_flat\_flat02f10\_badpixel.fits'],
          'BLAZE\_AB': ['20170710', '20170710\_flat\_dark02f10\_blaze\_AB.fits'],
          'BLAZE\_C': ['20170710', '20170710\_dark\_flat02f10\_blaze\_C.fits'],
          'DARK': ['20170710', '20170710\_dark\_dark02d406.fits'],
          'FLAT\_AB': ['20170710', '20170710\_flat\_dark02f10\_flat\_AB.fits'],
          'FLAT\_C': ['20170710', '20170710\_dark\_flat02f10\_flat\_C.fits'],
          'LOC\_AB': ['20170710', '20170710\_flat\_dark02f10\_loco\_AB.fits'],
          'LOC\_C': ['20170710', '20170710\_dark\_flat02f10\_loco\_C.fits'],
          'ORDER\_PROFILE\_AB': ['20170710',
           '20170710\_flat\_dark02f10\_order\_profile\_AB.fits'],
          'ORDER\_PROFILE\_C': ['20170710',
           '20170710\_dark\_flat02f10\_order\_profile\_C.fits'],
          'TILT': ['20170710', '20170710\_fp\_fp02a203\_tilt.fits'],
          'WAVE\_A': ['20170710', 'spirou\_wave\_ini3.fits'],
          'WAVE\_AB': ['AT4-04/2017-10-11\_21-32-17',
           '2017-10-11\_21-32-17\_hcone\_hcone02c406\_wave\_AB.fits'],
          'WAVE\_B': ['20170710', 'spirou\_wave\_ini3.fits'],
          'WAVE\_C': ['AT4-04/2017-10-11\_21-32-17',
           '2017-10-11\_21-32-17\_hcone\_hcone02c406\_wave\_C.fits']\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c+c1}{\PYZsh{} Note the acquisition time used is stored in two forms:}
        \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}time\PYZus{}human = \PYZob{}MAX\PYZus{}TIME\PYZus{}HUMAN\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{p}\PY{p}{)}\PY{p}{)}
        \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}time\PYZus{}unix = \PYZob{}MAX\PYZus{}TIME\PYZus{}UNIX\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{p}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
max\_time\_human = 2017-07-10-13:04:34.44
max\_time\_unix = 1499691874.44

    \end{Verbatim}

    Also note that the acquisition time decides which calibDB files are
used. This depends on the constants.

\begin{itemize}
\item
  If \texttt{calib\_db\_match="older} the recipes will only allow
  calibDB entries that are OLDER than the time in the main fits file
  (i.e. \texttt{\textless{}\ max\_time\_human} and
  \texttt{\textless{}\ max\_time\_unix}. This is the setup in the old
  DRS.
\item
  If \texttt{calib\_db\_match="closest} the recipes will used the
  closest entry in time to \texttt{max\_time\_human} and
  \texttt{max\_time\_unix}.
\end{itemize}

Note for this reason there is a check that \texttt{max\_time\_human} and
``max\_time\_unix``` are the same and that the human time and unix time
in the calibration database file are the same!

    \subsection{Updating the calibration
database}\label{updating-the-calibration-database}

This is very similar to before and involves a "PutFile" command to move
a file into the calibration database folder and a "UpdateMaster" command
to updated the master calibration database file (note one would have to
re-run \texttt{LoadCalibDB} to update the in-memory version of the
calibration database.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{} need a header for acquisition time in master calibration database file}
         \PY{n}{data}\PY{p}{,} \PY{n}{hdr}\PY{p}{,} \PY{n}{cmt}\PY{p}{,} \PY{n}{nx}\PY{p}{,} \PY{n}{ny} \PY{o}{=} \PY{n}{spirouImage}\PY{o}{.}\PY{n}{ReadImage}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n}{p}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fitsfilename}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TESTDATA}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} print header ACQTIME}
         \PY{n}{wargs} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ACQTIME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{hdr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ACQTIME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{cmt}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ACQTIME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{WLOG}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{p}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log\PYZus{}opt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZob{}0\PYZcb{} = \PYZob{}1\PYZcb{} /\PYZob{}2\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{n}{wargs}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} test output file}
         \PY{n}{outputfilename} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{20170710\PYZus{}dark\PYZus{}dark02d406.fits}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{outputfile} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{p}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{REDUCED\PYZus{}DIR}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{outputfilename}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} set database key}
         \PY{n}{keydb} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TEST}\PY{l+s+s1}{\PYZsq{}}
         \PY{c+c1}{\PYZsh{} copy localisation file to the calibDB folder}
         \PY{n}{spirouCDB}\PY{o}{.}\PY{n}{PutFile}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n}{outputfile}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} update the master calib DB file with new key}
         \PY{n}{spirouCDB}\PY{o}{.}\PY{n}{UpdateMaster}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n}{keydb}\PY{p}{,} \PY{n}{outputfilename}\PY{p}{,} \PY{n}{hdr}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
\textcolor{ansi-green-intense}{\textbf{16:01:51.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Reading TESTDATA Image /scratch/Projects/spirou\_py3/data/raw/20170710/flat\_dark02f10.fits}}
\textcolor{ansi-green-intense}{\textbf{16:01:51.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|TESTDATA Image 2048 x 2048 loaded}}
\textcolor{ansi-green-intense}{\textbf{16:01:51.0 -   |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|ACQTIME = 2457945.0448379633 /UTC Julian time}}
\textcolor{ansi-green-intense}{\textbf{16:01:51.0 - * |cal\_loc\_RAW\_spirou:02f10+[{\ldots}]|Updating Calib Data Base with TEST}}

    \end{Verbatim}

    And the output in the master calibration database file is as follows:

\begin{verbatim}
    TEST 20170710 20170710_dark_dark02d406.fits 2017-07-10-13:04:34.440000 1499691874.44
\end{verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
