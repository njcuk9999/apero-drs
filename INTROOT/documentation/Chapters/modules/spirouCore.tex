
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
\clearpage
\newpage
\begin{minipage}{\textwidth}
\section{The spirouCore module}
\label{ch:the_module:spirouCore}
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
\subsection{wlog}
\label{ch:the_module:spirouCore:logger}

Defined in \spirouCore\path{.spirouLog.logger}, also aliased in code to `WLOG'.

See Section \ref{ch:rules:drs_specific:logger} for usuage details.

\begin{pythonbox}
from SpirouDRS import spirouCore
spirouCore.wlog(key='', option='', message='')
spirouCore.spirouLog.logger(key='', option='', message='')
\end{pythonbox}

\begin{pythondocstring}
Parses a key (error/warning/info/graph), an option and a message to the
stdout and the log file.

keys are controlled by "spirouConfig.Constants.LOG_TRIG_KEYS()"
printing to screen is controlled by "PRINT_LEVEL" constant (config.py)
printing to log file is controlled by "LOG_LEVEL" constant (config.py)
based on the levels described in "spirouConfig.Constants.WRITE_LEVEL"

:param key: string, either "error" or "warning" or "info" or graph, this
            gives a character code in output
:param option: string, option code
:param message: string or list of strings, message to display or messages
                to display (1 line for each message in list)

output to stdout/log is as follows:

    HH:MM:SS.S - CODE |option|message

time is output in UTC to nearest .1 seconds

:return:
\end{pythondocstring}
\end{minipage}

%----------------------------------------------------------------------------------------
\begin{minipage}{\textwidth}
\subsection{warnlog}

Defined in \spirouCore\path{.spirouLog.warninglogger}

\begin{pythonbox}
from SpirouDRS import spirouCore
spirouCore.warnlog(w, funcname=None)
spirouCore.spirouLog.warninglogger(w, funcname=None)
\end{pythonbox}

\begin{pythondocstring}
Warning logger - takes "w" - a list of caught warnings and pipes them on
to the log functions. If "funcname" is not None then t "funcname" is
printed with the line reference (intended to be used to identify the code/
function/module warning was generated in)

to catch warnings use the following:

>>> import warnings
>>> with warnings.catch_warnings(record=True) as w:
>>>     code_to_generate_warnings()
>>> warninglogger(w, 'some name for logging')

:param w: list of warnings, the list of warnings from
           warnings.catch_warnings
:param funcname: string or None, if string then also pipes "funcname" to the
                 warning message (intended to be used to identify the code/
                 function/module warning was generated in)
:return:
\end{pythondocstring}
\end{minipage}

%----------------------------------------------------------------------------------------
\begin{minipage}{\textwidth}
\subsection{GaussFunction}

Defined in \spirouCore\path{.spirouMath.gauss_function}

\begin{pythonbox}
from SpirouDRS import spirouCore
spirouCore.GaussFunction(x, a, x0, sigma, dc)
spirouCore.spirouMath.gauss_function(x, a, x0, sigma, dc)
\end{pythonbox}

\begin{pythondocstring}
A standard 1D gaussian function (for fitting against)]=

:param x: numpy array (1D), the x data points
:param a: float, the amplitude
:param x0: float, the mean of the gaussian
:param sigma: float, the standard deviation (FWHM) of the gaussian
:param dc: float, the constant level below the gaussian

:return gauss: numpy array (1D), size = len(x), the output gaussian
\end{pythondocstring}
\end{minipage}

%----------------------------------------------------------------------------------------
\begin{minipage}{\textwidth}
\subsection{GetTimeNowUnix}

Defined in \spirouCore\path{.spirouMath.get_time_now_unix}

\begin{pythonbox}
from SpirouDRS import spirouCore
spirouCore.GetTimeNowUnix(zone='UTC')
spirouCore.spirouMath.get_time_now_unix(zone='UTC')
\end{pythonbox}

\begin{pythondocstring}
Get the unix_time now.

Default is to return unix_time in UTC/GMT time

:param zone: string, if UTC displays the time in UTC else displays local
             time

:return unix_time: float, the unix_time
\end{pythondocstring}
\end{minipage}

%----------------------------------------------------------------------------------------
\begin{minipage}{\textwidth}
\subsection{GetTimeNowString}

Defined in \spirouCore\path{.spirouMath.get_time_now_string}

\begin{pythonbox}
from SpirouDRS import spirouCore
spirouCore.GetTimeNowString(fmt=TIME_FMT, zone='UTC')
spirouCore.spirouMath.get_time_now_string(fmt=TIME_FMT, zone='UTC')
\end{pythonbox}

\begin{pythondocstring}
Get the time now (in string format = "fmt")

Default is to return string time in UTC/GMT time

    Commonly used format codes:

    %Y  Year with century as a decimal number.
    %m  Month as a decimal number [01,12].
    %d  Day of the month as a decimal number [01,31].
    %H  Hour (24-hour clock) as a decimal number [00,23].
    %M  Minute as a decimal number [00,59].
    %S  Second as a decimal number [00,61].
    %z  Time zone offset from UTC.
    %a  Locale's abbreviated weekday name.
    %A  Locale's full weekday name.
    %b  Locale's abbreviated month name.
    %B  Locale's full month name.
    %c  Locale's appropriate date and time representation.
    %I  Hour (12-hour clock) as a decimal number [01,12].
    %p  Locale's equivalent of either AM or PM.


:param fmt: string, the format code for the returned time
:param zone: string, if UTC displays the time in UTC else displays local
             time

:return stringtime: string, the time in a string in format = "fmt"
\end{pythondocstring}
\end{minipage}

%----------------------------------------------------------------------------------------
\begin{minipage}{\textwidth}
\subsection{Unix2stringTime}

Defined in \spirouCore\path{.spirouMath.unixtime2stringtime}

\begin{pythonbox}
from SpirouDRS import spirouCore
spirouCore.Unix2stringTime(ts, fmt=DATE_FMT, zone='UTC')
spirouCore.spirouMath.unixtime2stringtime(ts, fmt=DATE_FMT, zone='UTC')
\end{pythonbox}

\begin{pythondocstring}
Convert a unix time (seconds since  1970-01-01 00:00:00 GMT) into a
string in format "fmt". Currently supported timezones are UTC and local
(i.e. your current time zone).

Default is to return string time in UTC/GMT time

Commonly used format codes:

    %Y  Year with century as a decimal number.
    %m  Month as a decimal number [01,12].
    %d  Day of the month as a decimal number [01,31].
    %H  Hour (24-hour clock) as a decimal number [00,23].
    %M  Minute as a decimal number [00,59].
    %S  Second as a decimal number [00,61].
    %z  Time zone offset from UTC.
    %a  Locale's abbreviated weekday name.
    %A  Locale's full weekday name.
    %b  Locale's abbreviated month name.
    %B  Locale's full month name.
    %c  Locale's appropriate date and time representation.
    %I  Hour (12-hour clock) as a decimal number [01,12].
    %p  Locale's equivalent of either AM or PM.

:param ts: float or int, the unix time (seconds since 1970-01-01 00:00:00
           GMT)
:param fmt: string, the format of the string to convert
:param zone: string, the time zone for the input string
                      (currently supported =  "UTC" or "local")

:return stringtime: string, the time in format "fmt"
\end{pythondocstring}
\end{minipage}

%----------------------------------------------------------------------------------------
\begin{minipage}{\textwidth}
\subsection{String2unixTime}

Defined in \spirouCore\path{.spirouMath.stringtime2unixtime}

\begin{pythonbox}
from SpirouDRS import spirouCore
spirouCore.String2unixTime(string, fmt=DATE_FMT, zone='UTC')
spirouCore.spirouMath.stringtime2unixtime(string, fmt=DATE_FMT, zone='UTC')
\end{pythonbox}

\begin{pythondocstring}
Convert a string in format "fmt" into a float unix time (seconds since
1970-01-01 00:00:00 GMT). Currently supported timezones are UTC and local
(i.e. your current time zone).

Default is to assume string is in UTC/GMT time

Commonly used format codes:

    %Y  Year with century as a decimal number.
    %m  Month as a decimal number [01,12].
    %d  Day of the month as a decimal number [01,31].
    %H  Hour (24-hour clock) as a decimal number [00,23].
    %M  Minute as a decimal number [00,59].
    %S  Second as a decimal number [00,61].
    %z  Time zone offset from UTC.
    %a  Locale's abbreviated weekday name.
    %A  Locale's full weekday name.
    %b  Locale's abbreviated month name.
    %B  Locale's full month name.
    %c  Locale's appropriate date and time representation.
    %I  Hour (12-hour clock) as a decimal number [01,12].
    %p  Locale's equivalent of either AM or PM.

:param string: string, the time string to convert
:param fmt: string, the format of the string to convert
:param zone: string, the time zone for the input string
                      (currently supported =  "UTC" or "local")

:return unix_time: float, unix time (seconds since 1970-01-01 00:00:00 GMT)
\end{pythondocstring}
\end{minipage}

%----------------------------------------------------------------------------------------
\begin{minipage}{\textwidth}
\subsection{sPlt}

Defined in \spirouCore\path{.spirouPlot} (alias to the plotting module).

\begin{pythonbox}
from SpirouDRS import spirouCore
spirouCore.sPlt
spirouCore.spirouPlot
\end{pythonbox}

\begin{pythondocstring}
Spirou Plotting functions available:

start_interactive_session(interactive=False)
    Start interactive plot session, if required and if
    spirouConfig.Constants.INTERACITVE_PLOTS_ENABLED() is True

    :param interactive: bool, if True start interactive session

    :return None:

end_interactive_session(interactive=False)
    End interactive plot session, if required and if
    spirouConfig.Constants.INTERACITVE_PLOTS_ENABLED() is True

    :param interactive: bool, if True end interactive session

    :return None:


define_figure
    Define a figure number (mostly for use in interactive mode)

    :param num: int, a figure number

    :return figure: plt.figure instance

closeall()
    Close all matplotlib plots currently open

    :return None:

And all plotting functions from specific recipes.
\end{pythondocstring}
\end{minipage}

%----------------------------------------------------------------------------------------